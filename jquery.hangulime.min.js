/*!
 * jQuery Hangul IME 0.1
 *
 * Copyright 2011, Choongmin Lee
 * Licensed under the MIT license.
 *
 * Depends on:
 *     hangul.inputmethods.js (https://github.com/clee704/hangul-js)
 *     textinputs_jquery.js (http://code.google.com/p/rangyinputs)
 */
(function(k,i,d){var n={},m=[],s={dubeol:new i.dubeol.Automaton(m),sebeol:new i.sebeol.Automaton(m)},a=s.dubeol,r="hangul";function c(t){q(t.statusLabel);g(t.layoutChooser);o(t.editor)}function q(t){if(n.statusLabel){$(n.statusLabel).unbind("click",b)}n.statusLabel=t;if(t){$(t).click(b).text(r==="hangul"?"\ud55c":"A")}}function g(t){var u;if(n.layoutChooser){$(t).unbind("click",j)}n.layoutChooser=t;if(t){$(t).click(j);a=s[$(t+":checked").val()];a.reset()}}function o(u){var t={keypress:h,keydown:l,mousedown:p,blur:p};if(n.editor){$(n.editor).die(t)}n.editor=u;if(u){$(u).live(t)}}function b(){r=(r==="hangul"?"qwerty":"hangul");if(n.statusLabel){$(n.statusLabel).text(r==="hangul"?"\ud55c":"A")}a.reset()}function j(){a=s[$(this).val()];a.reset()}function h(t){var u=t.which;if(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey&&(u==32||u==229)||u==0||u==8||u==9||u==19||u==20||u==145){return}if(r==="hangul"){e($(this),t.which);return false}}function l(u){var v=u.which,t;if(u.shiftKey&&(u.which==32||u.which==229)){b();return false}else{if(r==="hangul"){t=$(this);if(v==8){return f(t)}else{if(u.metaKey||u.altKey||u.ctrlKey||v==9||v==19||v==20||v>=33&&v<=36||v==45||v==46||v==91||v>=112&&v<=123||v==145){a.reset()}}}}}function p(){if(r==="hangul"){a.reset()}}function e(u,v){var t;if(a.currentBlock!==d){t=u.getSelection();u.setSelection(t.end-1,t.end)}if(v==13){v=10}a.next(String.fromCharCode(v));if(m.length>0){u.replaceSelectedText(m.join(""));m.length=0}if(a.currentBlock!==d){u.replaceSelectedText(a.currentBlock)}}function f(u){var t;if(a.currentBlock===d){return true}else{t=u.getSelection();u.setSelection(t.end-1,t.end);a.next("\b");if(a.currentBlock===d){u.deleteSelectedText()}else{u.replaceSelectedText(a.currentBlock)}return false}}$.hangulime=c})(jQuery,hangul);