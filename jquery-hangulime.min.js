/**
 * jQuery Hangul IME
 * https://github.com/clee704/jQuery-Hangul-IME
 * Depends on:
 *   jQuery (http://jquery.com/)
 *   hangul.js, hangul-dubeol.js, hangul-sebeol.js (https://github.com/clee704/hangul-js)
 *   rangyinputs_jquery.js (http://code.google.com/p/rangyinputs)
 * @version 0.2
 * @copyright Copyright 2013, Choongmin Lee
 * @license MIT license
 */
(function(e,t,n){var r=[],i={dubeol:new t.dubeol.Automaton(r),sebeol:new t.sebeol.Automaton(r)},l=i.dubeol,u="hangul";var a={init:function(t){return this.each(function(){var n=e(this),r=n.data("hangulime");if(!r){var i=e.extend({},t),l={"keypress.hangulime":c,"keydown.hangulime":f,"mousedown.hangulime":h,"blur.hangulime":h};n.data("hangulime",{config:i}).bind(l)}})},destroy:function(){return this.each(function(){var t=e(this),n=t.data("hangulime");if(n){t.unbind(".hangulime").removeData("hangulime")}})}};e.fn.hangulime=function(t){if(a[t]){return a[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return a.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.hangulime")}};var o={BACKSPACE:8,TAB:9,RETURN:13,PAUSE_BREAK:19,CAPS_LOCK:20,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,LEFT_WINDOWS:91,RIGHT_WINDOWS:92,RIGHT_COMMAND:93,F1:112,F12:123,SCROLL_LOCK:145,IME:229};function c(t){var n=e(this),r=t.which;if(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey&&(r==o.SPACE||r==o.IME)||r==0||r==o.BACKSPACE||r==o.TAB||r==o.PAUSE_BREAK||r==o.CAPS_LOCK||r==o.SCROLL_LOCK){return}if(u==="hangul")return E(n,t.which)}function f(t){var n=e(this),r=t.which;if(t.shiftKey&&(r==o.SPACE||r==o.IME)){s();return false}if(t.altKey&&r==o.SPACE){A();return false}else if(u==="hangul"){if(r==o.BACKSPACE){return S(n)}else if(t.metaKey||t.altKey||t.ctrlKey||r==o.TAB||r==o.PAUSE_BREAK||r==o.CAPS_LOCK||r==o.INSERT||r==o.DELETE||r==o.LEFT_WINDOWS||r==o.RIGHT_WINDOWS||r==o.SCROLL_LOCK||r>=o.PAGE_UP&&r<=o.DOWN_ARROW||r>=o.F1&&r<=o.F12){l.reset()}}}function h(){if(u==="hangul")l.reset()}function s(){u=u==="hangul"?"qwerty":"hangul";l.reset()}function A(){l=l===i.dubeol?i.sebeol:i.dubeol;l.reset()}function E(e,t){var i=false;if(l.currentBlock!==n){var u=e.getSelection();e.setSelection(u.end-1,u.end);if(e.getSelection().text!==l.currentBlock){e.setSelection(u.start,u.end)}}if(t==o.RETURN){t=10}var a=String.fromCharCode(t);l.next(a);if(r.length>0){if(r[r.length-1]===a&&l.currentBlock===n){r.pop();i=true}e.replaceSelectedText(r.join(""));r.length=0;if(i){return}}if(l.currentBlock!==n){e.replaceSelectedText(l.currentBlock)}return false}function S(e){if(l.currentBlock===n){return true}else{var t=e.getSelection();e.setSelection(t.end-1,t.end);l.next("\b");if(l.currentBlock===n){e.deleteSelectedText()}else{e.replaceSelectedText(l.currentBlock)}return false}}})(jQuery,hangul);